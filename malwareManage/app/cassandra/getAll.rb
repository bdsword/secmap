require 'cassandra'

client = Cassandra.new('SECMAP',"192.168.100.107:9160")
count = 100
list = client.get_range_keys(:SUMMARY, :key_count => 100)
first = list[0]
last = nil
list.each do |sample|
	puts sample
	last = sample
end

while true do
	begin
		list = client.get_range_keys(:SUMMARY, :key_count => 100, :start_key=>last)
	rescue
		next
	end
	flag = false
	list.each do |sample|
		puts sample
		last = sample
		begin
			cc = client.get(:SUMMARY, sample)
		rescue
			next
		end
		if sample == first
			flag = true
		end
	end
	if flag
		break
	end
	if list.size < 100
		break
	end
	count += 100
	p count
end
